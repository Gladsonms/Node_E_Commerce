<div class="app-main" id="main">
    <!-- begin container-fluid -->
    <div class="container-fluid">
        <!-- begin row -->
        <div class="row">
            <div class="col-md-12 m-b-30">
                <!-- begin page title -->
                <div class="d-block d-sm-flex flex-nowrap align-items-center">
                    <div class="page-title mb-2 mb-sm-0">
                        <h1>Account </h1>
                    </div>
                    <div class="ml-auto d-flex align-items-center">

                    </div>
                </div>
                <!-- end page title -->
            </div>
        </div>
        <!-- end row -->

        <!--mail-Compose-contant-start-->
        <div class="row account-contant">
            <div class="col-12">
                <div class="card card-statistics">
                    <div class="card-body p-0">
                        <div class="row no-gutters">
                            <div class="col-xl-3 pb-xl-0 pb-5 border-right">
                                <div class="page-account-profil pt-5">
                                    <div class="profile-img text-center rounded-circle">
                                        <div class="pt-5">
                                            <div class="bg-img m-auto">
                                                <img src="assets/img/avtar/01.jpg" class="img-fluid" alt="users-avatar">
                                            </div>
                                            <div class="profile pt-4">
                                                <h4 class="mb-1">{{user.username}}</h4>
                                                <p>Enthusiast</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="py-5 profile-counter">
                                        <ul class="nav justify-content-center text-center">
                                            <li class="nav-item border-right px-3">
                                                <div>
                                                    <h4 class="mb-0">90</h4>
                                                    <p>Post</p>
                                                </div>
                                            </li>

                                            <li class="nav-item border-right px-3">
                                                <div>
                                                    <h4 class="mb-0">1.5K</h4>
                                                    <p>Messages</p>
                                                </div>
                                            </li>

                                            <li class="nav-item px-3">
                                                <div>
                                                    <h4 class="mb-0">4.4K</h4>
                                                    <p>Members</p>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>

                                    <div class="profile-btn text-center">
                                        <div><button class="btn btn-light text-primary mb-2">Upload New Avatar</button>
                                        </div>
                                        <div><button class="btn btn-danger">Delete</button></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-5 col-md-6 col-12 border-t border-right">
                                <div class="page-account-form">
                                    <div class="form-titel border-bottom p-3">
                                        <h5 class="mb-0 py-2">Edit Your Personal Information</h5>
                                    </div>
                                    <div class="p-4">
                                        <form id="userDetails">
                                            <div class="form-row">
                                                <div class="form-group col-md-12">
                                                    <label for="name1">Full Name</label>
                                                    <input type="text" class="form-control" id="name1"
                                                        value="{{user.username}}" name="username">
                                                </div>
                                                {{!-- <div class="form-group col-md-12">
                                                    <label for="title1">Title</label>
                                                    <input type="text" class="form-control" id="title1"
                                                        value="Marketing expert">
                                                </div> --}}
                                                <div class="form-group col-md-12">
                                                    <label for="phone1">Phone Number</label>
                                                    <input type="text" class="form-control" id="phone1"
                                                        value="{{user.phone}}" name="phone">
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <label for="email1">Email</label>
                                                    <input type="email" class="form-control" id="email1"
                                                        value="{{user.email}}" name="email">
                                                </div>
                                            </div>



                                            <button type="submit" class="btn btn-primary">Update Information</button>
                                        </form>
                                    </div>
                                    <div>
                                        <p class="ml-5">
                                            <a class="btn btn-primary" data-toggle="collapse" href="#collapseExample"
                                                role="button" aria-expanded="false" aria-controls="collapseExample">
                                                Change password
                                            </a>

                                        </p>
                                        <div class="collapse" id="collapseExample">
                                            <div class="card card-body">
                                                <!--Section: Block Content-->
                                                <section class="mb-5 text-center">

                                                    <p>Set a new password</p>

                                                    <form action="/change-password" id="change">
                                                        <div class="md-form md-outline mx-sm-3 mb-2">
                                                            <input type="password" id="newPass" class="form-control" name="oldpassowrd">
                                                            <label data-error="wrong" data-success="right"
                                                                for="newPass">Current password</label>
                                                        </div>

                                                        <div class="md-form md-outline mx-sm-3 mb-2">
                                                            <input type="password" id="newPass" class="form-control" name="newpassword">
                                                            <label data-error="wrong" data-success="right"
                                                                for="newPass">New password</label>
                                                        </div>

                                                        <div class="md-form md-outline mx-sm-3 mb-2">
                                                            <input type="password" id="newPassConfirm"
                                                                class="form-control" name="confirmnewpassword">
                                                            <label data-error="wrong" data-success="right"
                                                                for="newPassConfirm">Confirm password</label>
                                                        </div>

                                                        <button  type="submit" class="btn btn-primary mb-4">Change
                                                            password</button>

                                                    </form>

                                                    <div class="d-flex justify-content-between align-items-center mb-2">



                                                    </div>

                                                </section>
                                                <!--Section: Block Content-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-4 col-md-6 border-t col-12">
                                <div class="page-account-form">
                                    <div class="form-titel border-bottom p-3">
                                        <h5 class="mb-0 py-2">Your address</h5>
                                    </div>
                                    <div class="p-4">
                                        {{!-- <form> --}}
                                            {{#each useraddres.address}}
                                            <div class="form-group">
                                                <span for="fb">Adresss</span>
                                                <input type="button" class="form-control" id="fb"
                                                    value="{{this.name}} ,  {{this.phone}}  ,  {{this.place}},  {{this.address}} ,  {{this.city}} ">
                                                <div class=""><button class="btn btn-danger mt-2"
                                                        onclick="deleteAddress('{{this.id}}','{{this.name}}','{{this.addressId}}','{{this.id}}');">Delete</button>
                                                </div>
                                            </div>
                                            {{/each}}






                                            <button type="submit" class="btn btn-primary">Save & Update</button>
                                        {{!-- </form> --}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--mail-Compose-contant-end-->
    </div>
    <!-- end container-fluid -->

</div>
<script>
    function deleteAddress(userId, username, address, addressId) {

        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                $.ajax({
                    url: "/oders/deleteaddress",
                    data: {
                        userId,
                        username,
                        addressId,
                        address
                    },
                    method: "POST",
                    success: (response) => {
                        if (response) {

                            window.location.reload()
                        }
                    }
                })

            }
            else {

            }




        })
    }


    document.getElementById('userDetails').onsubmit = e => {
        e.preventDefault();

 
        $.ajax({
            url: "/profile/user-details",
            data: $('#userDetails').serialize(),
            method: "post",
            success: (response) => {
    
                if (response.status) {
                   
                    window.location.reload()

                }
            }

        })
    }
    
    document.getElementById('change').onsubmit=e=>{
        e.preventDefault();
        
      $.ajax({
          url:"/change-password",
          method:"post",
          data:$("#change").serialize()
          
      })
    }
</script>